<?php

declare(strict_types=1);

namespace ApiClients\Client\GitHub\Schema;

use EventSauce\ObjectHydrator\MapFrom;

final readonly class PrivateVulnerabilityReportCreate
{
    public const SCHEMA_JSON         = '{
    "required": [
        "summary",
        "description"
    ],
    "type": "object",
    "properties": {
        "summary": {
            "maxLength": 1024,
            "type": "string",
            "description": "A short summary of the advisory."
        },
        "description": {
            "maxLength": 65535,
            "type": "string",
            "description": "A detailed description of what the advisory impacts."
        },
        "vulnerabilities": {
            "type": [
                "array",
                "null"
            ],
            "items": {
                "required": [
                    "package"
                ],
                "type": "object",
                "properties": {
                    "package": {
                        "required": [
                            "ecosystem"
                        ],
                        "type": "object",
                        "properties": {
                            "ecosystem": {
                                "enum": [
                                    "rubygems",
                                    "npm",
                                    "pip",
                                    "maven",
                                    "nuget",
                                    "composer",
                                    "go",
                                    "rust",
                                    "erlang",
                                    "actions",
                                    "pub",
                                    "other",
                                    "swift"
                                ],
                                "type": "string",
                                "description": "The package\'s language or package management ecosystem."
                            },
                            "name": {
                                "type": [
                                    "string",
                                    "null"
                                ],
                                "description": "The unique package name within its ecosystem."
                            }
                        },
                        "description": "The name of the package affected by the vulnerability."
                    },
                    "vulnerable_version_range": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "description": "The range of the package versions affected by the vulnerability."
                    },
                    "patched_versions": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "description": "The package version(s) that resolve the vulnerability."
                    },
                    "vulnerable_functions": {
                        "type": [
                            "array",
                            "null"
                        ],
                        "items": {
                            "type": "string"
                        },
                        "description": "The functions in the package that are affected."
                    }
                },
                "additionalProperties": false
            },
            "description": "An array of products affected by the vulnerability detailed in a repository security advisory."
        },
        "cwe_ids": {
            "type": [
                "array",
                "null"
            ],
            "items": {
                "type": "string"
            },
            "description": "A list of Common Weakness Enumeration (CWE) IDs."
        },
        "severity": {
            "enum": [
                "critical",
                "high",
                "medium",
                "low",
                null
            ],
            "type": [
                "string",
                "null"
            ],
            "description": "The severity of the advisory. You must choose between setting this field or `cvss_vector_string`."
        },
        "cvss_vector_string": {
            "type": [
                "string",
                "null"
            ],
            "description": "The CVSS vector that calculates the severity of the advisory. You must choose between setting this field or `severity`."
        },
        "start_private_fork": {
            "type": "boolean",
            "description": "Whether to create a temporary private fork of the repository to collaborate on a fix.",
            "default": false
        }
    },
    "additionalProperties": false
}';
    public const SCHEMA_TITLE        = '';
    public const SCHEMA_DESCRIPTION  = '';
    public const SCHEMA_EXAMPLE_DATA = '{
    "summary": "generated",
    "description": "generated",
    "vulnerabilities": null,
    "cwe_ids": null,
    "severity": "low",
    "cvss_vector_string": "generated",
    "start_private_fork": false
}';

    /**
     * summary: A short summary of the advisory.
     * description: A detailed description of what the advisory impacts.
     * vulnerabilities: An array of products affected by the vulnerability detailed in a repository security advisory.
     * cweIds: A list of Common Weakness Enumeration (CWE) IDs.
     * severity: The severity of the advisory. You must choose between setting this field or `cvss_vector_string`.
     * cvssVectorString: The CVSS vector that calculates the severity of the advisory. You must choose between setting this field or `severity`.
     * startPrivateFork: Whether to create a temporary private fork of the repository to collaborate on a fix.
     */
    public function __construct(public string $summary, public string $description, public array|null $vulnerabilities, #[MapFrom('cwe_ids')]
    public array|null $cweIds, public string|null $severity, #[MapFrom('cvss_vector_string')]
    public string|null $cvssVectorString, #[MapFrom('start_private_fork')]
    public bool|null $startPrivateFork,)
    {
    }
}
